<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MusicPlay - Player Profissional</title><!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"><!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #121212;
            color: #ffffff;
            overflow-x: hidden;
            overflow-y: auto;
            height: 100%;
            box-sizing: border-box;
        }

        /* Temas Animados - Expandidos */
        .theme-sweater {
            background: linear-gradient(135deg, #050a15 0%, #0d1a2f 100%);
            position: relative;
        }

        .theme-sunset {
            background: linear-gradient(135deg, #1a0a0f 0%, #2f1520 100%);
            position: relative;
        }

        .theme-forest {
            background: linear-gradient(135deg, #0a150a 0%, #152f15 100%);
            position: relative;
        }

        .theme-purple {
            background: linear-gradient(135deg, #150a1a 0%, #2f1540 100%);
            position: relative;
        }

        .theme-ocean {
            background: linear-gradient(135deg, #0a1520 0%, #153040 100%);
            position: relative;
        }

        .theme-gold {
            background: linear-gradient(135deg, #1a1510 0%, #2f2515 100%);
            position: relative;
        }

        .theme-neon {
            background: linear-gradient(135deg, #0f0a1a 0%, #1a0f2f 100%);
            position: relative;
        }

        .theme-rose {
            background: linear-gradient(135deg, #1a0a15 0%, #2f152a 100%);
            position: relative;
        }

        .theme-mint {
            background: linear-gradient(135deg, #0a1a15 0%, #152f25 100%);
            position: relative;
        }

        .theme-cyber {
            background: linear-gradient(135deg, #0a1a1a 0%, #152f2f 100%);
            position: relative;
        }

        .theme-fire {
            background: linear-gradient(135deg, #1a0f0a 0%, #2f1f15 100%);
            position: relative;
        }

        .theme-ice {
            background: linear-gradient(135deg, #0a151a 0%, #15252f 100%);
            position: relative;
        }

        /* Partículas e Animações de Background */
        .theme-particles::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
        }

        .theme-sweater::before {
            background: 
                radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(147, 197, 253, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(96, 165, 250, 0.25) 0%, transparent 50%);
            animation: pulseBlue 8s ease-in-out infinite;
        }

        .theme-sunset::before {
            background: 
                radial-gradient(circle at 30% 40%, rgba(251, 146, 60, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 70% 60%, rgba(239, 68, 68, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(245, 101, 101, 0.25) 0%, transparent 50%);
            animation: pulseSunset 10s ease-in-out infinite;
        }

        .theme-forest::before {
            background: 
                radial-gradient(circle at 25% 35%, rgba(34, 197, 94, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 75% 65%, rgba(74, 222, 128, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 45% 75%, rgba(16, 185, 129, 0.25) 0%, transparent 50%);
            animation: pulseForest 9s ease-in-out infinite;
        }

        .theme-purple::before {
            background: 
                radial-gradient(circle at 35% 25%, rgba(168, 85, 247, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 65% 75%, rgba(196, 181, 253, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 20% 60%, rgba(147, 51, 234, 0.25) 0%, transparent 50%);
            animation: pulsePurple 11s ease-in-out infinite;
        }

        .theme-ocean::before {
            background: 
                radial-gradient(circle at 40% 30%, rgba(14, 165, 233, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 60% 70%, rgba(56, 189, 248, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 40%, rgba(2, 132, 199, 0.25) 0%, transparent 50%);
            animation: pulseOcean 12s ease-in-out infinite;
        }

        .theme-gold::before {
            background: 
                radial-gradient(circle at 30% 50%, rgba(245, 158, 11, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(251, 191, 36, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(217, 119, 6, 0.25) 0%, transparent 50%);
            animation: pulseGold 10s ease-in-out infinite;
        }

        .theme-neon::before {
            background: 
                radial-gradient(circle at 25% 25%, rgba(236, 72, 153, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.2) 0%, transparent 50%);
            animation: pulseNeon 7s ease-in-out infinite;
        }

        .theme-rose::before {
            background: 
                radial-gradient(circle at 30% 40%, rgba(244, 114, 182, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 70% 60%, rgba(251, 113, 133, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(236, 72, 153, 0.2) 0%, transparent 50%);
            animation: pulseRose 9s ease-in-out infinite;
        }

        .theme-mint::before {
            background: 
                radial-gradient(circle at 20% 30%, rgba(52, 211, 153, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(110, 231, 183, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(16, 185, 129, 0.2) 0%, transparent 50%);
            animation: pulseMint 8s ease-in-out infinite;
        }

        .theme-cyber::before {
            background: 
                radial-gradient(circle at 35% 25%, rgba(6, 182, 212, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 65% 75%, rgba(34, 197, 94, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 40%, rgba(14, 165, 233, 0.25) 0%, transparent 50%);
            animation: pulseCyber 6s ease-in-out infinite;
        }

        .theme-fire::before {
            background: 
                radial-gradient(circle at 40% 30%, rgba(239, 68, 68, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 60% 70%, rgba(251, 146, 60, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 30% 80%, rgba(245, 101, 101, 0.25) 0%, transparent 50%);
            animation: pulseFire 5s ease-in-out infinite;
        }

        .theme-ice::before {
            background: 
                radial-gradient(circle at 25% 35%, rgba(125, 211, 252, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 75% 65%, rgba(186, 230, 253, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(56, 189, 248, 0.2) 0%, transparent 50%);
            animation: pulseIce 11s ease-in-out infinite;
        }

        /* Partículas flutuantes */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 2;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            opacity: 0.5;
            animation: floatUp 20s linear infinite;
            will-change: transform;
            transition: opacity 0.3s ease;
        }

        .theme-sweater .particle { background: #60a5fa; box-shadow: 0 0 6px rgba(96, 165, 250, 0.3); }
        .theme-sunset .particle { background: #fb923c; box-shadow: 0 0 6px rgba(251, 146, 60, 0.3); }
        .theme-forest .particle { background: #4ade80; box-shadow: 0 0 6px rgba(74, 222, 128, 0.3); }
        .theme-purple .particle { background: #a855f7; box-shadow: 0 0 6px rgba(168, 85, 247, 0.3); }
        .theme-ocean .particle { background: #38bdf8; box-shadow: 0 0 6px rgba(56, 189, 248, 0.3); }
        .theme-gold .particle { background: #fbbf24; box-shadow: 0 0 6px rgba(251, 191, 36, 0.3); }
        .theme-neon .particle { background: #ec4899; box-shadow: 0 0 8px rgba(236, 72, 153, 0.4); }
        .theme-rose .particle { background: #f472b6; box-shadow: 0 0 6px rgba(244, 114, 182, 0.3); }
        .theme-mint .particle { background: #34d399; box-shadow: 0 0 6px rgba(52, 211, 153, 0.3); }
        .theme-cyber .particle { background: #06b6d4; box-shadow: 0 0 8px rgba(6, 182, 212, 0.4); }
        .theme-fire .particle { background: #ef4444; box-shadow: 0 0 8px rgba(239, 68, 68, 0.4); }
        .theme-ice .particle { background: #7dd3fc; box-shadow: 0 0 6px rgba(125, 211, 252, 0.3); }

        @keyframes floatUp {
            0% { 
                transform: translateY(calc(100vh + 20px)) translateX(0) scale(0); 
                opacity: 0; 
            }
            10% { 
                opacity: 0.4; 
                transform: translateY(90vh) translateX(0) scale(1); 
            }
            90% { 
                opacity: 0.4; 
                transform: translateY(10vh) translateX(var(--drift, 0px)) scale(1); 
            }
            100% { 
                transform: translateY(-20px) translateX(var(--drift, 0px)) scale(0); 
                opacity: 0; 
            }
        }

        @keyframes pulseBlue { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        @keyframes pulseSunset { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }
        @keyframes pulseForest { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        @keyframes pulsePurple { 0%, 100% { opacity: 0.9; } 50% { opacity: 1; } }
        @keyframes pulseOcean { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        @keyframes pulseGold { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }
        @keyframes pulseNeon { 0%, 100% { opacity: 0.9; } 33% { opacity: 1; } 66% { opacity: 0.8; } }
        @keyframes pulseRose { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        @keyframes pulseMint { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }
        @keyframes pulseCyber { 0%, 100% { opacity: 1; } 25% { opacity: 0.8; } 75% { opacity: 0.9; } }
        @keyframes pulseFire { 0%, 100% { opacity: 0.9; } 20% { opacity: 1; } 40% { opacity: 0.8; } 80% { opacity: 1; } }
        @keyframes pulseIce { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }

        /* Layout Principal */
        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
            z-index: 10;
        }

        /* Sidebar */
        .sidebar {
            width: 232px;
            background: #000000;
            padding: 24px 12px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: calc(100vh - 90px);
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 32px;
            padding: 0 12px;
        }

        .logo i {
            font-size: 28px;
            color: #1DB954;
        }

        .logo span {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            color: #b3b3b3;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #ffffff;
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-link i {
            font-size: 20px;
            width: 20px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 232px;
            padding: 24px;
            overflow-y: auto;
            height: calc(100vh - 90px);
            position: relative;
            z-index: 10;
        }

        /* Header */
        .header {
            margin-bottom: 32px;
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #ffffff;
        }

        .search-container {
            position: relative;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 48px;
            border: none;
            border-radius: 24px;
            background: #ffffff;
            color: #000000;
            font-size: 14px;
            font-weight: 500;
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #000000;
            font-size: 16px;
        }

        /* Music Grid */
        .music-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .music-card {
            background: #181818;
            border-radius: 8px;
            padding: 16px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .music-card:hover {
            background: #282828;
            transform: scale(1.02);
        }

        .card-cover {
            width: 100%;
            aspect-ratio: 1;
            background: #404040;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
        }

        .card-cover i {
            font-size: 48px;
            color: #b3b3b3;
        }

        .card-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        .play-button {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 40px;
            height: 40px;
            background: #1DB954;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000000;
            font-size: 16px;
            cursor: pointer;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.2s ease;
        }

        .music-card:hover .play-button {
            opacity: 1;
            transform: translateY(0);
        }

        .play-button:hover {
            transform: scale(1.1);
        }

        .download-button {
            position: absolute;
            bottom: 8px;
            left: 8px;
            width: 40px;
            height: 40px;
            background: #404040;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: 16px;
            cursor: pointer;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.2s ease;
        }

        .music-card:hover .download-button {
            opacity: 1;
            transform: translateY(0);
        }

        .download-button:hover {
            transform: scale(1.1);
            background: #1DB954;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .card-artist {
            font-size: 14px;
            color: #b3b3b3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Player */
        .player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 90px;
            background: #181818;
            border-top: 1px solid #282828;
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 1000;
        }

        .player-left {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 30%;
            min-width: 180px;
        }

        .player-cover {
            width: 56px;
            height: 56px;
            background: #404040;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .player-cover i {
            font-size: 24px;
            color: #b3b3b3;
        }

        .player-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-info h4 {
            font-size: 14px;
            font-weight: 500;
            color: #ffffff;
            margin-bottom: 2px;
        }

        .player-info p {
            font-size: 12px;
            color: #b3b3b3;
        }

        .player-center {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            max-width: 722px;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .control-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 16px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .control-btn:hover {
            color: #ffffff;
            transform: scale(1.1);
        }

        .play-pause-btn {
            width: 32px;
            height: 32px;
            background: #ffffff;
            color: #000000;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .play-pause-btn:hover {
            transform: scale(1.1);
            background: #ffffff;
            color: #000000;
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            max-width: 500px;
        }

        .time-display {
            font-size: 12px;
            color: #b3b3b3;
            min-width: 40px;
            text-align: center;
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: #404040;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: #1DB954;
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s ease;
        }

        .progress-bar:hover .progress-fill {
            background: #1ed760;
        }

        .player-right {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 30%;
            min-width: 180px;
            justify-content: flex-end;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .volume-slider {
            width: 80px;
            height: 4px;
            background: #404040;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .volume-fill {
            height: 100%;
            background: #1DB954;
            border-radius: 2px;
            width: 100%;
        }

        /* Sidebar de Letras */
        .lyrics-sidebar {
            position: fixed;
            right: 0;
            top: 0;
            width: 350px;
            height: calc(100vh - 90px);
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding: 24px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 200;
            overflow-y: auto;
        }

        .lyrics-sidebar.active {
            transform: translateX(0);
        }

        .lyrics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .lyrics-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
        }

        .close-lyrics {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .close-lyrics:hover {
            color: #ffffff;
            background: rgba(255, 255, 255, 0.1);
        }

        .lyrics-content {
            text-align: center;
        }

        .lyrics-line {
            font-size: 24px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 16px;
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            transition: all 0.5s ease;
            text-shadow: 0 0 20px rgba(29, 185, 84, 0.5);
            line-height: 1.4;
        }

        .lyrics-line.active {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .lyrics-line.fade-out {
            opacity: 0.3;
            transform: translateY(-10px) scale(0.95);
        }

        /* Modais */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #282828;
            border-radius: 8px;
            padding: 32px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 48px;
            color: #1DB954;
            margin-bottom: 16px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 16px;
        }

        .modal-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #404040;
            border-radius: 4px;
            background: #181818;
            color: #ffffff;
            font-size: 16px;
            margin-bottom: 24px;
            outline: none;
        }

        .modal-input:focus {
            border-color: #1DB954;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .modal-btn.primary {
            background: #1DB954;
            color: #000000;
        }

        .modal-btn.primary:hover {
            background: #1ed760;
            transform: scale(1.05);
        }

        .modal-btn.secondary {
            background: transparent;
            color: #ffffff;
            border: 1px solid #404040;
        }

        .modal-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Painel de Administração */
        .admin-panel {
            position: fixed;
            right: 0;
            top: 0;
            width: 500px;
            height: 100vh;
            background: #181818;
            border-left: 1px solid #282828;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1500;
            overflow-y: auto;
        }

        .admin-panel.active {
            transform: translateX(0);
        }

        .admin-header {
            padding: 24px;
            border-bottom: 1px solid #282828;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-title {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
        }

        .close-admin {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .close-admin:hover {
            color: #ffffff;
            background: rgba(255, 255, 255, 0.1);
        }

        .admin-content {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #404040;
            border-radius: 4px;
            background: #282828;
            color: #ffffff;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: #1DB954;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .icon-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .icon-option {
            aspect-ratio: 1;
            border: 2px solid #404040;
            border-radius: 4px;
            background: #282828;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #b3b3b3;
            font-size: 20px;
        }

        .icon-option:hover,
        .icon-option.selected {
            border-color: #1DB954;
            color: #1DB954;
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .theme-option {
            aspect-ratio: 2;
            border: 2px solid #404040;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .theme-option:hover,
        .theme-option.selected {
            border-color: #1DB954;
        }

        .theme-option.sweater { background: linear-gradient(135deg, #050a15 0%, #0d1a2f 100%); }
        .theme-option.sunset { background: linear-gradient(135deg, #1a0a0f 0%, #2f1520 100%); }
        .theme-option.forest { background: linear-gradient(135deg, #0a150a 0%, #152f15 100%); }
        .theme-option.purple { background: linear-gradient(135deg, #150a1a 0%, #2f1540 100%); }
        .theme-option.ocean { background: linear-gradient(135deg, #0a1520 0%, #153040 100%); }
        .theme-option.gold { background: linear-gradient(135deg, #1a1510 0%, #2f2515 100%); }
        .theme-option.neon { background: linear-gradient(135deg, #0f0a1a 0%, #1a0f2f 100%); }
        .theme-option.rose { background: linear-gradient(135deg, #1a0a15 0%, #2f152a 100%); }
        .theme-option.mint { background: linear-gradient(135deg, #0a1a15 0%, #152f25 100%); }
        .theme-option.cyber { background: linear-gradient(135deg, #0a1a1a 0%, #152f2f 100%); }
        .theme-option.fire { background: linear-gradient(135deg, #1a0f0a 0%, #2f1f15 100%); }
        .theme-option.ice { background: linear-gradient(135deg, #0a151a 0%, #15252f 100%); }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #1DB954;
            color: #000000;
            border: none;
            border-radius: 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 24px;
        }

        .submit-btn:hover {
            background: #1ed760;
            transform: translateY(-2px);
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            background: #1DB954;
            color: #000000;
            padding: 16px 24px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: #e53e3e;
            color: #ffffff;
        }

        /* Animação de erro */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Mobile Responsivo - Layout Completamente Novo */
        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
                padding: 16px 8px;
                transform: translateX(0);
                position: fixed;
                left: 0;
                top: 0;
                height: calc(100vh - 120px);
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(20px);
                border-right: 1px solid rgba(255, 255, 255, 0.1);
                z-index: 100;
            }

            .sidebar.mobile-hidden {
                transform: translateX(0);
            }

            .logo {
                margin-bottom: 20px;
                padding: 0;
                justify-content: center;
            }

            .logo span {
                display: none;
            }

            .logo i {
                font-size: 24px;
            }

            .nav-menu {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }

            .nav-link {
                padding: 12px 8px;
                justify-content: center;
                border-radius: 12px;
                position: relative;
                min-height: 48px;
            }

            .nav-link span {
                display: none;
            }

            .nav-link i {
                font-size: 18px;
            }

            .nav-link.active::after {
                content: '';
                position: absolute;
                right: -8px;
                top: 50%;
                transform: translateY(-50%);
                width: 3px;
                height: 20px;
                background: #1DB954;
                border-radius: 2px;
            }

            .main-content {
                margin-left: 80px;
                padding: 16px 12px;
                height: calc(100vh - 120px);
                padding-bottom: 20px;
            }

            .header {
                margin-bottom: 20px;
            }

            .welcome-title {
                font-size: 20px;
                margin-bottom: 16px;
                line-height: 1.2;
            }

            .search-container {
                max-width: 100%;
            }

            .search-input {
                padding: 14px 16px 14px 44px;
                font-size: 16px;
                border-radius: 20px;
            }

            .music-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin-top: 16px;
            }

            .music-card {
                padding: 12px;
                border-radius: 12px;
                background: rgba(24, 24, 24, 0.8);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.05);
            }

            .card-cover {
                margin-bottom: 12px;
                border-radius: 12px;
                aspect-ratio: 1;
            }

            .card-cover i {
                font-size: 32px;
            }

            .card-title {
                font-size: 14px;
                font-weight: 600;
                margin-bottom: 4px;
            }

            .card-artist {
                font-size: 12px;
            }

            .play-button,
            .download-button {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }

            .favorite-btn {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }

            /* Player Mobile Otimizado */
            .player {
                height: 120px;
                padding: 12px 16px;
                background: rgba(24, 24, 24, 0.95);
                backdrop-filter: blur(20px);
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                display: grid;
                grid-template-columns: auto 1fr auto;
                grid-template-rows: auto auto;
                gap: 8px 12px;
                align-items: center;
            }

            .player-left {
                grid-column: 1;
                grid-row: 1 / 3;
                width: auto;
                min-width: auto;
            }

            .player-cover {
                width: 48px;
                height: 48px;
                border-radius: 8px;
            }

            .player-cover i {
                font-size: 20px;
            }

            .player-info {
                display: none;
            }

            .player-center {
                grid-column: 2;
                grid-row: 1 / 3;
                max-width: none;
                gap: 6px;
            }

            .player-controls {
                gap: 8px;
                justify-content: center;
            }

            .control-btn {
                padding: 6px;
                font-size: 14px;
            }

            .play-pause-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .progress-container {
                max-width: 100%;
                gap: 8px;
            }

            .time-display {
                font-size: 10px;
                min-width: 32px;
            }

            .player-right {
                grid-column: 3;
                grid-row: 1 / 3;
                width: auto;
                min-width: auto;
                justify-content: flex-end;
            }

            .volume-container {
                flex-direction: column;
                gap: 4px;
            }

            .volume-slider {
                width: 4px;
                height: 60px;
                writing-mode: bt-lr;
                -webkit-appearance: slider-vertical;
            }

            .volume-fill {
                width: 100%;
                height: 100%;
            }

            /* Modais Mobile */
            .modal-content {
                padding: 24px 20px;
                margin: 0 16px;
                max-width: none;
                width: calc(100% - 32px);
            }

            .lyrics-sidebar {
                width: 100%;
                padding: 16px;
                height: calc(100vh - 120px);
            }

            .lyrics-line {
                font-size: 18px;
                margin-bottom: 12px;
            }

            .admin-panel {
                width: 100%;
                padding-top: 60px;
            }

            .admin-content {
                padding: 20px 16px;
            }

            .form-input,
            .form-select,
            .form-textarea {
                padding: 14px 16px;
                font-size: 16px;
                border-radius: 8px;
            }

            .icon-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
            }

            .theme-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .theme-option {
                aspect-ratio: 1.5;
                border-radius: 8px;
            }

            .submit-btn {
                padding: 16px;
                font-size: 16px;
                border-radius: 12px;
            }

            /* Estados vazios mobile */
            .empty-state {
                padding: 32px 16px;
            }

            .empty-state i {
                font-size: 48px;
            }

            .empty-state h3 {
                font-size: 20px;
            }

            .empty-state p {
                font-size: 14px;
            }

            /* Toast mobile */
            .toast {
                top: 16px;
                right: 16px;
                left: 16px;
                transform: translateY(-100px);
                border-radius: 12px;
                padding: 16px 20px;
            }

            .toast.show {
                transform: translateY(0);
            }

            /* Configurações mobile */
            .settings-container {
                padding: 0;
            }

            .settings-section {
                margin-bottom: 16px;
                padding: 20px 16px;
                border-radius: 12px;
            }

            .theme-selector {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }

            .theme-card {
                aspect-ratio: 1.5;
                border-radius: 8px;
            }

            .theme-card div {
                font-size: 10px;
                bottom: 4px;
                left: 4px;
            }

            /* Botão menu mobile removido */
            .mobile-menu-btn {
                display: none;
            }

            /* Animações suaves para mobile */
            .music-card {
                transition: all 0.2s ease;
            }

            .music-card:active {
                transform: scale(0.98);
            }

            .nav-link {
                transition: all 0.2s ease;
            }

            .nav-link:active {
                transform: scale(0.95);
            }

            /* Melhor contraste para mobile */
            .card-title,
            .card-artist {
                text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            }

            /* Scroll suave */
            .main-content {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }

            /* Otimizações de toque */
            .control-btn,
            .play-button,
            .download-button,
            .favorite-btn {
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }
        }

        /* Estados vazios */
        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: #b3b3b3;
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 8px;
            color: #ffffff;
        }

        .empty-state p {
            font-size: 16px;
        }

        /* Favoritos */
        .favorite-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: #b3b3b3;
            font-size: 16px;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
        }

        .music-card:hover .favorite-btn {
            opacity: 1;
        }

        .favorite-btn.active {
            color: #1DB954;
            opacity: 1;
        }

        .favorite-btn:hover {
            color: #1DB954;
            transform: scale(1.1);
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 48px;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #404040;
            border-top: 3px solid #1DB954;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Botão Menu Mobile --> <button class="mobile-menu-btn" id="mobileMenuBtn" style="display: none;"> <i class="fas fa-bars"></i> </button> <!-- Container Principal -->
  <div class="app-container theme-sweater theme-particles" id="appContainer"><!-- Partículas Flutuantes -->
   <div class="floating-particles" id="floatingParticles"></div><!-- Sidebar -->
   <nav class="sidebar" id="sidebar">
    <div class="logo"><i class="fas fa-headphones"></i> <span>MusicPlay</span>
    </div>
    <ul class="nav-menu">
     <li class="nav-item"><a href="#" class="nav-link active" data-tab="home"> <i class="fas fa-home"></i> <span>Início</span> </a></li>
     <li class="nav-item"><a href="#" class="nav-link" data-tab="search"> <i class="fas fa-search"></i> <span>Buscar</span> </a></li>
     <li class="nav-item"><a href="#" class="nav-link" data-tab="favorites"> <i class="fas fa-star"></i> <span>Favoritos</span> </a></li>
     <li class="nav-item"><a href="#" class="nav-link" data-tab="add"> <i class="fas fa-plus"></i> <span>Adicionar</span> </a></li>
     <li class="nav-item"><a href="#" class="nav-link" data-tab="settings"> <i class="fas fa-cog"></i> <span>Configurações</span> </a></li>
    </ul>
   </nav><!-- Conteúdo Principal -->
   <main class="main-content" id="mainContent"><!-- Header -->
    <header class="header">
     <h1 class="welcome-title" id="welcomeTitle">Bem-vindo de volta</h1>
     <div class="search-container"><i class="fas fa-search search-icon"></i> <input type="text" class="search-input" id="searchInput" placeholder="O que você quer ouvir?">
     </div>
    </header><!-- Grid de Músicas -->
    <div class="music-grid" id="musicGrid"><!-- Músicas serão carregadas aqui -->
    </div><!-- Estado Vazio -->
    <div class="empty-state" id="emptyState" style="display: none;"><i class="fas fa-music"></i>
     <h3>Nenhuma música encontrada</h3>
     <p>Adicione suas primeiras músicas para começar</p>
    </div><!-- Loading -->
    <div class="loading" id="loading" style="display: none;">
     <div class="spinner"></div>
    </div>
   </main><!-- Sidebar de Letras -->
   <div class="lyrics-sidebar" id="lyricsSidebar">
    <div class="lyrics-header">
     <h3 class="lyrics-title">Letras</h3><button class="close-lyrics" id="closeLyrics"> <i class="fas fa-times"></i> </button>
    </div>
    <div class="lyrics-content" id="lyricsContent"><!-- Letras aparecerão aqui -->
    </div>
   </div>
  </div><!-- Player -->
  <div class="player" id="player">
   <div class="player-left">
    <div class="player-cover" id="playerCover"><i class="fas fa-music"></i>
    </div>
    <div class="player-info">
     <h4 id="playerTitle">Selecione uma música</h4>
     <p id="playerArtist">Artista</p>
    </div>
   </div>
   <div class="player-center">
    <div class="player-controls"><button class="control-btn" id="shuffleBtn"> <i class="fas fa-random"></i> </button> <button class="control-btn" id="prevBtn"> <i class="fas fa-step-backward"></i> </button> <button class="control-btn play-pause-btn" id="playPauseBtn"> <i class="fas fa-play"></i> </button> <button class="control-btn" id="nextBtn"> <i class="fas fa-step-forward"></i> </button> <button class="control-btn" id="repeatBtn"> <i class="fas fa-redo"></i> </button>
    </div>
    <div class="progress-container"><span class="time-display" id="currentTime">0:00</span>
     <div class="progress-bar" id="progressBar">
      <div class="progress-fill" id="progressFill"></div>
     </div><span class="time-display" id="totalTime">0:00</span>
    </div>
   </div>
   <div class="player-right">
    <div class="volume-container"><button class="control-btn" id="volumeBtn"> <i class="fas fa-volume-up"></i> </button>
     <div class="volume-slider" id="volumeSlider">
      <div class="volume-fill" id="volumeFill"></div>
     </div>
    </div>
   </div>
  </div><!-- Modal de Senha -->
  <div class="modal" id="passwordModal">
   <div class="modal-content"><i class="fas fa-lock modal-icon"></i>
    <h2 class="modal-title">Área Administrativa</h2><input type="password" class="modal-input" id="passwordInput" placeholder="Digite a senha">
    <div class="modal-buttons"><button class="modal-btn secondary" id="cancelPassword">Cancelar</button> <button class="modal-btn primary" id="confirmPassword">Entrar</button>
    </div>
   </div>
  </div><!-- Painel de Administração -->
  <div class="admin-panel" id="adminPanel">
   <div class="admin-header">
    <h2 class="admin-title">Adicionar Música</h2><button class="close-admin" id="closeAdmin"> <i class="fas fa-times"></i> </button>
   </div>
   <div class="admin-content">
    <form id="addMusicForm">
     <div class="form-group"><label class="form-label">URL da Música ou Arquivo</label> <input type="text" class="form-input" id="musicUrl" placeholder="Cole o link do YouTube ou MP3">
      <div style="margin-top: 8px; text-align: center;"><span style="color: #b3b3b3; font-size: 12px;">ou</span>
      </div><input type="file" class="form-input" id="musicFile" accept="audio/*" style="margin-top: 8px;">
      <div style="margin-top: 4px; font-size: 12px; color: #b3b3b3;">
       Formatos suportados: MP3, WAV, OGG, M4A, AAC
      </div>
     </div>
     <div class="form-group"><label class="form-label">Nome da Música</label> <input type="text" class="form-input" id="musicTitle" placeholder="Título da música">
     </div>
     <div class="form-group"><label class="form-label">Artista</label> <input type="text" class="form-input" id="musicArtist" placeholder="Nome do artista">
     </div>
     <div class="form-group"><label class="form-label">Ícone</label>
      <div class="icon-grid" id="iconGrid">
       <div class="icon-option selected" data-icon="fas fa-music">
        <i class="fas fa-music"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-guitar">
        <i class="fas fa-guitar"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-drum">
        <i class="fas fa-drum"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-microphone">
        <i class="fas fa-microphone"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-headphones">
        <i class="fas fa-headphones"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-compact-disc">
        <i class="fas fa-compact-disc"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-record-vinyl">
        <i class="fas fa-record-vinyl"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-heart">
        <i class="fas fa-heart"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-star">
        <i class="fas fa-star"></i>
       </div>
       <div class="icon-option" data-icon="fas fa-fire">
        <i class="fas fa-fire"></i>
       </div>
      </div>
     </div>
     <div class="form-group"><label class="form-label">Tema de Fundo</label>
      <div class="theme-grid" id="themeGrid" style="grid-template-columns: repeat(3, 1fr); gap: 8px;">
       <div class="theme-option selected sweater" data-theme="sweater" title="Azul Clássico"></div>
       <div class="theme-option sunset" data-theme="sunset" title="Pôr do Sol"></div>
       <div class="theme-option forest" data-theme="forest" title="Floresta"></div>
       <div class="theme-option purple" data-theme="purple" title="Roxo Místico"></div>
       <div class="theme-option ocean" data-theme="ocean" title="Oceano"></div>
       <div class="theme-option gold" data-theme="gold" title="Dourado"></div>
       <div class="theme-option neon" data-theme="neon" title="Neon Vibrante"></div>
       <div class="theme-option rose" data-theme="rose" title="Rosa Elegante"></div>
       <div class="theme-option mint" data-theme="mint" title="Menta Fresca"></div>
       <div class="theme-option cyber" data-theme="cyber" title="Cyber Tech"></div>
       <div class="theme-option fire" data-theme="fire" title="Fogo Intenso"></div>
       <div class="theme-option ice" data-theme="ice" title="Gelo Cristalino"></div>
      </div>
     </div>
     <div class="form-group"><label class="form-label">Texto Romântico/Poético</label> <textarea class="form-textarea" id="musicLyrics" placeholder="Digite o texto linha por linha..."></textarea>
     </div>
     <div class="form-group"><label class="form-label">Intervalo entre linhas (segundos)</label> <input type="number" class="form-input" id="lyricsInterval" value="3" min="1" max="10">
     </div><button type="submit" class="submit-btn"> <i class="fas fa-plus"></i> Adicionar Música </button>
    </form>
   </div>
  </div><!-- Toast Notifications -->
  <div class="toast" id="toast"></div><!-- Audio Elements -->
  <audio id="audioPlayer" preload="metadata"></audio><!-- Firebase SDK -->
  <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD2uryhbal6zUmbhAyfUoElJaE5CyMIwfM",
            authDomain: "dengoplay-9defc.firebaseapp.com",
            databaseURL: "https://dengoplay-9defc-default-rtdb.firebaseio.com",
            projectId: "dengoplay-9defc",
            storageBucket: "dengoplay-9defc.firebasestorage.app",
            messagingSenderId: "933875447662",
            appId: "1:933875447662:web:9e073c0fc0b092be90b37f",
            measurementId: "G-JQLHXD6QEW"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        window.firebaseDB = database;
        window.firebaseRef = ref;
        window.firebasePush = push;
        window.firebaseSet = set;
        window.firebaseOnValue = onValue;
        window.firebaseRemove = remove;
    </script>
  <script>
        // Variáveis Globais
        let currentSong = null;
        let currentIndex = 0;
        let isPlaying = false;
        let songs = [];
        let filteredSongs = [];
        let currentTab = 'home';
        let isAuthenticated = false;
        let currentTheme = 'sweater';
        let youtubePlayer = null;
        let isYouTubeReady = false;
        let ytApiLoaded = false;
        let currentLyrics = [];
        let lyricsInterval = null;
        let currentLyricsIndex = 0;

        // Elementos DOM
        const elements = {
            sidebar: document.getElementById('sidebar'),
            mainContent: document.getElementById('mainContent'),
            musicGrid: document.getElementById('musicGrid'),
            emptyState: document.getElementById('emptyState'),
            loading: document.getElementById('loading'),
            searchInput: document.getElementById('searchInput'),
            welcomeTitle: document.getElementById('welcomeTitle'),
            
            // Player
            player: document.getElementById('player'),
            playerCover: document.getElementById('playerCover'),
            playerTitle: document.getElementById('playerTitle'),
            playerArtist: document.getElementById('playerArtist'),
            playPauseBtn: document.getElementById('playPauseBtn'),
            prevBtn: document.getElementById('prevBtn'),
            nextBtn: document.getElementById('nextBtn'),
            shuffleBtn: document.getElementById('shuffleBtn'),
            repeatBtn: document.getElementById('repeatBtn'),
            progressBar: document.getElementById('progressBar'),
            progressFill: document.getElementById('progressFill'),
            currentTime: document.getElementById('currentTime'),
            totalTime: document.getElementById('totalTime'),
            volumeBtn: document.getElementById('volumeBtn'),
            volumeSlider: document.getElementById('volumeSlider'),
            volumeFill: document.getElementById('volumeFill'),
            
            // Modais e Painéis
            passwordModal: document.getElementById('passwordModal'),
            passwordInput: document.getElementById('passwordInput'),
            confirmPassword: document.getElementById('confirmPassword'),
            cancelPassword: document.getElementById('cancelPassword'),
            adminPanel: document.getElementById('adminPanel'),
            closeAdmin: document.getElementById('closeAdmin'),
            
            // Formulário
            addMusicForm: document.getElementById('addMusicForm'),
            musicUrl: document.getElementById('musicUrl'),
            musicFile: document.getElementById('musicFile'),
            musicTitle: document.getElementById('musicTitle'),
            musicArtist: document.getElementById('musicArtist'),
            musicLyrics: document.getElementById('musicLyrics'),
            lyricsInterval: document.getElementById('lyricsInterval'),
            iconGrid: document.getElementById('iconGrid'),
            themeGrid: document.getElementById('themeGrid'),
            
            // Letras
            lyricsSidebar: document.getElementById('lyricsSidebar'),
            closeLyrics: document.getElementById('closeLyrics'),
            lyricsContent: document.getElementById('lyricsContent'),
            
            // Mobile
            mobileMenuBtn: document.getElementById('mobileMenuBtn'),
            
            // Toast
            toast: document.getElementById('toast'),
            
            // Audio
            audioPlayer: document.getElementById('audioPlayer'),
            
            // Container
            appContainer: document.getElementById('appContainer'),
            floatingParticles: document.getElementById('floatingParticles')
        };

        // Sistema de download de músicas
        function downloadSong(event, index) {
            event.stopPropagation();
            
            const song = filteredSongs[index];
            if (!song) return;
            
            if (song.type === 'youtube') {
                // Para YouTube, abrir em nova aba
                const youtubeUrl = `https://www.youtube.com/watch?v=${song.youtubeId}`;
                window.open(youtubeUrl, '_blank', 'noopener,noreferrer');
                showToast('Abrindo YouTube em nova aba');
                return;
            }
            
            // Para arquivos MP3/locais
            if (song.url) {
                try {
                    // Determinar extensão do arquivo
                    let extension = '.mp3';
                    if (song.fileName) {
                        const fileExt = song.fileName.split('.').pop();
                        if (fileExt) extension = '.' + fileExt;
                    } else if (song.mimeType) {
                        const mimeMap = {
                            'audio/mpeg': '.mp3',
                            'audio/mp3': '.mp3',
                            'audio/wav': '.wav',
                            'audio/ogg': '.ogg',
                            'audio/m4a': '.m4a',
                            'audio/aac': '.aac'
                        };
                        extension = mimeMap[song.mimeType] || '.mp3';
                    }
                    
                    const link = document.createElement('a');
                    link.href = song.url;
                    link.download = `${song.title} - ${song.artist}${extension}`;
                    link.style.display = 'none';
                    
                    // Adicionar ao DOM temporariamente
                    document.body.appendChild(link);
                    
                    // Simular clique
                    link.click();
                    
                    // Remover do DOM
                    setTimeout(() => {
                        document.body.removeChild(link);
                    }, 100);
                    
                    showToast(`Baixando: ${song.title}`);
                    console.log('Download iniciado:', song.title);
                    
                } catch (error) {
                    console.error('Erro no download:', error);
                    
                    // Fallback: tentar abrir em nova aba
                    try {
                        window.open(song.url, '_blank', 'noopener,noreferrer');
                        showToast('Abrindo arquivo em nova aba');
                    } catch (fallbackError) {
                        console.error('Erro no fallback:', fallbackError);
                        showToast('Erro ao baixar música', 'error');
                    }
                }
            } else {
                showToast('URL da música não encontrada', 'error');
            }
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadSongs();
            createParticles();
            checkMobile();
        });

        // Função de Inicialização
        function initializeApp() {
            console.log('MusicPlay iniciado!');
            
            // Configurar volume inicial
            elements.audioPlayer.volume = 1;
            updateVolumeDisplay(1);
            
            // Configurar tema inicial
            changeTheme('sweater');
        }

        // Event Listeners
        function setupEventListeners() {
            // Navegação
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', handleNavigation);
            });
            
            // Busca
            elements.searchInput.addEventListener('input', handleSearch);
            
            // Player Controls
            elements.playPauseBtn.addEventListener('click', togglePlayPause);
            elements.prevBtn.addEventListener('click', playPrevious);
            elements.nextBtn.addEventListener('click', playNext);
            elements.shuffleBtn.addEventListener('click', toggleShuffle);
            elements.repeatBtn.addEventListener('click', toggleRepeat);
            
            // Progress Bar
            elements.progressBar.addEventListener('click', handleProgressClick);
            
            // Volume
            elements.volumeSlider.addEventListener('click', handleVolumeClick);
            elements.volumeBtn.addEventListener('click', toggleMute);
            
            // Modal de Senha
            elements.confirmPassword.addEventListener('click', checkPassword);
            elements.cancelPassword.addEventListener('click', closePasswordModal);
            elements.passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkPassword();
            });
            
            // Admin Panel
            elements.closeAdmin.addEventListener('click', closeAdminPanel);
            elements.addMusicForm.addEventListener('submit', handleAddMusic);
            
            // URL Input - Auto-preenchimento
            elements.musicUrl.addEventListener('input', handleUrlInput);
            
            // File Input - Upload de arquivos
            elements.musicFile.addEventListener('change', handleFileUpload);
            
            // Seleção de Ícones
            elements.iconGrid.addEventListener('click', handleIconSelection);
            
            // Seleção de Temas
            elements.themeGrid.addEventListener('click', handleThemeSelection);
            
            // Letras
            elements.closeLyrics.addEventListener('click', closeLyricsSidebar);
            
            // Mobile Menu
            elements.mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            
            // Audio Events
            elements.audioPlayer.addEventListener('timeupdate', updateProgress);
            elements.audioPlayer.addEventListener('loadedmetadata', updateDuration);
            elements.audioPlayer.addEventListener('ended', playNext);
            
            // Fechar modais clicando fora
            elements.passwordModal.addEventListener('click', function(e) {
                if (e.target === elements.passwordModal) {
                    closePasswordModal();
                }
            });
            
            // Resize
            window.addEventListener('resize', checkMobile);
        }

        // Navegação
        function handleNavigation(e) {
            e.preventDefault();
            const tab = e.currentTarget.dataset.tab;
            
            // Remover classe ativa de todos os links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Adicionar classe ativa ao link clicado
            e.currentTarget.classList.add('active');
            
            // Mudar tab atual
            currentTab = tab;
            
            // Atualizar título da página
            updatePageTitle(tab);
            
            // Executar ação baseada na tab
            switch(tab) {
                case 'home':
                    showAllSongs();
                    break;
                case 'search':
                    showSearchTab();
                    break;
                case 'favorites':
                    showFavorites();
                    break;
                case 'add':
                    if (isAuthenticated) {
                        openAdminPanel();
                    } else {
                        openPasswordModal();
                    }
                    break;
                case 'settings':
                    showSettingsTab();
                    break;
            }
            
            // Fechar menu mobile se estiver aberto
            if (window.innerWidth <= 768) {
                elements.sidebar.classList.remove('mobile-visible');
            }
        }

        // Atualizar título da página
        function updatePageTitle(tab) {
            const titles = {
                'home': 'Bem-vindo de volta',
                'search': 'Buscar Músicas',
                'favorites': 'Suas Músicas Favoritas',
                'add': 'Adicionar Nova Música',
                'settings': 'Configurações'
            };
            
            elements.welcomeTitle.textContent = titles[tab] || 'MusicPlay';
        }

        // Mostrar aba de busca
        function showSearchTab() {
            elements.searchInput.focus();
            
            // Se não há termo de busca, mostrar todas as músicas
            if (!elements.searchInput.value.trim()) {
                filteredSongs = [...songs];
            }
            
            renderSongs();
            
            // Adicionar dica de busca se não há músicas
            if (songs.length === 0) {
                elements.musicGrid.innerHTML = `
                    <div class="search-tips" style="grid-column: 1 / -1; text-align: center; padding: 48px 24px; color: #b3b3b3;">
                        <i class="fas fa-search" style="font-size: 64px; margin-bottom: 16px; opacity: 0.5;"></i>
                        <h3 style="font-size: 24px; margin-bottom: 16px; color: #ffffff;">Busque suas músicas favoritas</h3>
                        <p style="font-size: 16px; margin-bottom: 24px;">Digite o nome da música ou artista na barra de busca</p>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 16px;">
                            <span style="background: #282828; padding: 8px 16px; border-radius: 20px; font-size: 14px;">Rock</span>
                            <span style="background: #282828; padding: 8px 16px; border-radius: 20px; font-size: 14px;">Pop</span>
                            <span style="background: #282828; padding: 8px 16px; border-radius: 20px; font-size: 14px;">Sertanejo</span>
                            <span style="background: #282828; padding: 8px 16px; border-radius: 20px; font-size: 14px;">Eletrônica</span>
                        </div>
                    </div>
                `;
            }
        }

        // Mostrar aba de configurações
        function showSettingsTab() {
            elements.musicGrid.innerHTML = `
                <div class="settings-container" style="grid-column: 1 / -1; max-width: 600px; margin: 0 auto;">
                    <div class="settings-section" style="background: #181818; border-radius: 8px; padding: 24px; margin-bottom: 24px;">
                        <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                            <i class="fas fa-palette"></i> Aparência
                        </h3>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: #ffffff; font-weight: 600; margin-bottom: 12px;">Tema de Fundo</label>
                            <div class="theme-selector" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <div class="theme-card ${currentTheme === 'sweater' ? 'active' : ''}" data-theme="sweater" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'sweater' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #050a15 0%, #0d1a2f 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Azul</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'sunset' ? 'active' : ''}" data-theme="sunset" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'sunset' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #1a0a0f 0%, #2f1520 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Sunset</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'forest' ? 'active' : ''}" data-theme="forest" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'forest' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0a150a 0%, #152f15 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Forest</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'purple' ? 'active' : ''}" data-theme="purple" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'purple' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #150a1a 0%, #2f1540 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Purple</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'ocean' ? 'active' : ''}" data-theme="ocean" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'ocean' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0a1520 0%, #153040 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Ocean</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'gold' ? 'active' : ''}" data-theme="gold" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'gold' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #1a1510 0%, #2f2515 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Gold</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'neon' ? 'active' : ''}" data-theme="neon" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'neon' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0f0a1a 0%, #1a0f2f 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Neon</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'rose' ? 'active' : ''}" data-theme="rose" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'rose' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #1a0a15 0%, #2f152a 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Rose</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'mint' ? 'active' : ''}" data-theme="mint" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'mint' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0a1a15 0%, #152f25 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Mint</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'cyber' ? 'active' : ''}" data-theme="cyber" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'cyber' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0a1a1a 0%, #152f2f 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Cyber</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'fire' ? 'active' : ''}" data-theme="fire" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'fire' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #1a0f0a 0%, #2f1f15 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Fire</div>
                                </div>
                                <div class="theme-card ${currentTheme === 'ice' ? 'active' : ''}" data-theme="ice" style="aspect-ratio: 1.5; border: 2px solid ${currentTheme === 'ice' ? '#1DB954' : '#404040'}; border-radius: 8px; cursor: pointer; background: linear-gradient(135deg, #0a151a 0%, #15252f 100%); position: relative; overflow: hidden;">
                                    <div style="position: absolute; bottom: 4px; left: 4px; color: #ffffff; font-size: 10px; font-weight: 600;">Ice</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section" style="background: #181818; border-radius: 8px; padding: 24px; margin-bottom: 24px;">
                        <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                            <i class="fas fa-music"></i> Reprodução
                        </h3>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <div>
                                <div style="color: #ffffff; font-weight: 600; margin-bottom: 4px;">Reprodução Automática</div>
                                <div style="color: #b3b3b3; font-size: 14px;">Tocar próxima música automaticamente</div>
                            </div>
                            <label class="toggle-switch" style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                <input type="checkbox" id="autoplayToggle" checked style="opacity: 0; width: 0; height: 0;">
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #1DB954; border-radius: 24px; transition: 0.3s;">
                                    <span style="position: absolute; content: ''; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; border-radius: 50%; transition: 0.3s; transform: translateX(26px);"></span>
                                </span>
                            </label>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <div>
                                <div style="color: #ffffff; font-weight: 600; margin-bottom: 4px;">Mostrar Letras</div>
                                <div style="color: #b3b3b3; font-size: 14px;">Exibir letras automaticamente</div>
                            </div>
                            <label class="toggle-switch" style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                <input type="checkbox" id="lyricsToggle" checked style="opacity: 0; width: 0; height: 0;">
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #1DB954; border-radius: 24px; transition: 0.3s;">
                                    <span style="position: absolute; content: ''; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; border-radius: 50%; transition: 0.3s; transform: translateX(26px);"></span>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section" style="background: #181818; border-radius: 8px; padding: 24px; margin-bottom: 24px;">
                        <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                            <i class="fas fa-cog"></i> Administração
                        </h3>
                        
                        <button onclick="openPasswordModal()" style="width: 100%; padding: 16px; background: #1DB954; color: #000000; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; margin-bottom: 12px; transition: all 0.2s ease;">
                            <i class="fas fa-plus"></i> Adicionar Nova Música
                        </button>
                        
                        <button onclick="clearAllData()" style="width: 100%; padding: 16px; background: #e53e3e; color: #ffffff; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s ease;">
                            <i class="fas fa-trash"></i> Limpar Todas as Músicas
                        </button>
                    </div>

                    <div class="settings-section" style="background: #181818; border-radius: 8px; padding: 24px;">
                        <h3 style="color: #ffffff; font-size: 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                            <i class="fas fa-info-circle"></i> Sobre
                        </h3>
                        
                        <div style="color: #b3b3b3; line-height: 1.6;">
                            <p style="margin-bottom: 12px;"><strong style="color: #ffffff;">MusicPlay</strong> - Player de música profissional</p>
                            <p style="margin-bottom: 12px;">Versão 2.0.0</p>
                            <p style="margin-bottom: 12px;">Suporte a YouTube, MP3 e arquivos locais</p>
                            <p>Desenvolvido com amor para amantes da música</p>
                        </div>
                    </div>
                </div>
            `;

            // Adicionar event listeners para os temas
            document.querySelectorAll('.theme-card').forEach(card => {
                card.addEventListener('click', function() {
                    const theme = this.dataset.theme;
                    changeTheme(theme);
                    
                    // Atualizar visual dos cards
                    document.querySelectorAll('.theme-card').forEach(c => {
                        c.style.border = '2px solid #404040';
                    });
                    this.style.border = '2px solid #1DB954';
                    
                    showToast(`Tema ${this.textContent} aplicado!`);
                });
            });
        }

        // Busca
        function handleSearch() {
            const query = elements.searchInput.value.toLowerCase().trim();
            
            if (query === '') {
                filteredSongs = [...songs];
            } else {
                filteredSongs = songs.filter(song => 
                    song.title.toLowerCase().includes(query) ||
                    song.artist.toLowerCase().includes(query)
                );
            }
            
            renderSongs();
        }

        // Mostrar todas as músicas
        function showAllSongs() {
            filteredSongs = [...songs];
            renderSongs();
        }

        // Mostrar favoritos
        function showFavorites() {
            filteredSongs = songs.filter(song => song.favorite);
            renderSongs();
        }

        // Carregar músicas do Firebase
        function loadSongs() {
            if (!window.firebaseDB) {
                console.log('Firebase não inicializado ainda');
                setTimeout(loadSongs, 1000);
                return;
            }
            
            elements.loading.style.display = 'flex';
            
            const songsRef = window.firebaseRef(window.firebaseDB, 'songs');
            window.firebaseOnValue(songsRef, (snapshot) => {
                const data = snapshot.val();
                songs = [];
                
                if (data) {
                    Object.keys(data).forEach(key => {
                        const song = { id: key, ...data[key] };
                        
                        // Validar e corrigir dados da música
                        if (song.url && song.type === 'youtube') {
                            // Converter para URL embed do YouTube para melhor compatibilidade
                            if (song.youtubeId) {
                                song.embedUrl = `https://www.youtube.com/embed/${song.youtubeId}?enablejsapi=1&origin=${window.location.origin}`;
                                song.directUrl = `https://www.youtube.com/watch?v=${song.youtubeId}`;
                            }
                        } else if (song.url && song.type === 'mp3') {
                            // Validar URLs de MP3
                            if (!song.url.startsWith('data:') && !song.url.startsWith('blob:') && !song.url.startsWith('http')) {
                                console.warn('URL de MP3 inválida para:', song.title);
                                // Não adicionar músicas com URLs inválidas
                                return;
                            }
                        }
                        
                        // Garantir campos obrigatórios
                        if (!song.title || !song.artist) {
                            console.warn('Música com dados incompletos:', song);
                            return;
                        }
                        
                        songs.push(song);
                    });
                }
                
                // Ordenar por data de criação (mais recentes primeiro)
                songs.sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
                
                filteredSongs = [...songs];
                renderSongs();
                elements.loading.style.display = 'none';
                
                console.log(`${songs.length} músicas válidas carregadas do Firebase`);
            });
        }

        // Renderizar músicas
        function renderSongs() {
            if (filteredSongs.length === 0) {
                elements.musicGrid.style.display = 'none';
                elements.emptyState.style.display = 'block';
                return;
            }
            
            elements.emptyState.style.display = 'none';
            elements.musicGrid.style.display = 'grid';
            
            elements.musicGrid.innerHTML = filteredSongs.map((song, index) => `
                <div class="music-card" data-index="${index}" onclick="playSong(${index})">
                    <div class="card-cover">
                        <i class="${song.icon || 'fas fa-music'}"></i>
                        ${song.thumbnail ? `<img src="${song.thumbnail}" alt="${song.title}">` : ''}
                        <button class="favorite-btn ${song.favorite ? 'active' : ''}" onclick="toggleFavorite(event, '${song.id}')">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                    <button class="play-button" onclick="playSong(${index})">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="download-button" onclick="downloadSong(event, ${index})" title="Baixar música">
                        <i class="fas fa-download"></i>
                    </button>
                    <h3 class="card-title">${song.title}</h3>
                    <p class="card-artist">${song.artist}</p>
                </div>
            `).join('');
        }

        // Tocar música
        function playSong(index) {
            if (index < 0 || index >= filteredSongs.length) return;
            
            currentIndex = index;
            currentSong = filteredSongs[index];
            
            // Atualizar UI do player
            updatePlayerUI();
            
            // Mudar tema se especificado
            if (currentSong.theme) {
                changeTheme(currentSong.theme);
            }
            
            // Preparar letras
            if (currentSong.lyrics) {
                prepareLyrics(currentSong.lyrics, currentSong.lyricsInterval || 3);
            }
            
            // Tocar áudio - apenas MP3 para evitar erros
            if (currentSong.type === 'youtube') {
                // Para YouTube, mostrar aviso e abrir em nova aba
                showToast('Músicas do YouTube serão abertas em nova aba');
                const youtubeUrl = `https://www.youtube.com/watch?v=${currentSong.youtubeId}`;
                window.open(youtubeUrl, '_blank');
                return;
            } else {
                playMP3(currentSong.url);
            }
            
            // Mostrar sidebar de letras se houver letras
            if (currentSong.lyrics) {
                showLyricsSidebar();
            }
        }

        // Atualizar UI do Player
        function updatePlayerUI() {
            if (!currentSong) return;
            
            elements.playerTitle.textContent = currentSong.title;
            elements.playerArtist.textContent = currentSong.artist;
            
            // Atualizar capa
            elements.playerCover.innerHTML = currentSong.thumbnail ? 
                `<img src="${currentSong.thumbnail}" alt="${currentSong.title}">` :
                `<i class="${currentSong.icon || 'fas fa-music'}"></i>`;
        }

        // Tocar MP3
        function playMP3(url) {
            if (!url) {
                showToast('URL da música não encontrada!', 'error');
                return;
            }
            
            // Parar reprodução anterior
            elements.audioPlayer.pause();
            elements.audioPlayer.currentTime = 0;
            
            // Configurar áudio com verificação
            try {
                elements.audioPlayer.src = url;
                elements.audioPlayer.load();
                
                // Aguardar carregamento antes de tentar reproduzir
                elements.audioPlayer.addEventListener('canplay', function onCanPlay() {
                    elements.audioPlayer.removeEventListener('canplay', onCanPlay);
                    
                    const playPromise = elements.audioPlayer.play();
                    
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            isPlaying = true;
                            updatePlayButton();
                            startLyrics();
                            console.log('Reproduzindo:', currentSong.title);
                        }).catch(error => {
                            console.error('Erro ao tocar:', error);
                            handlePlayError(error);
                        });
                    }
                });
                
                // Tratar erros de carregamento
                elements.audioPlayer.addEventListener('error', function onError(e) {
                    elements.audioPlayer.removeEventListener('error', onError);
                    console.error('Erro no áudio:', e);
                    
                    const error = elements.audioPlayer.error;
                    if (error) {
                        switch(error.code) {
                            case error.MEDIA_ERR_ABORTED:
                                showToast('Reprodução cancelada pelo usuário');
                                break;
                            case error.MEDIA_ERR_NETWORK:
                                showToast('Erro de rede ao carregar áudio', 'error');
                                break;
                            case error.MEDIA_ERR_DECODE:
                                showToast('Erro ao decodificar áudio - Formato inválido', 'error');
                                break;
                            case error.MEDIA_ERR_SRC_NOT_SUPPORTED:
                                showToast('Formato de áudio não suportado', 'error');
                                break;
                            default:
                                showToast('Erro desconhecido ao reproduzir áudio', 'error');
                        }
                    }
                    
                    isPlaying = false;
                    updatePlayButton();
                });
                
            } catch (error) {
                console.error('Erro ao configurar áudio:', error);
                showToast('Erro ao configurar reprodução', 'error');
                isPlaying = false;
                updatePlayButton();
            }
        }
        
        // Tratar erros de reprodução
        function handlePlayError(error) {
            isPlaying = false;
            updatePlayButton();
            
            switch(error.name) {
                case 'NotAllowedError':
                    showToast('Clique em play novamente para iniciar');
                    break;
                case 'NotSupportedError':
                    showToast('Formato de áudio não suportado', 'error');
                    break;
                case 'AbortError':
                    showToast('Reprodução interrompida');
                    break;
                default:
                    showToast('Erro ao reproduzir - Tente novamente', 'error');
            }
        }

        // Sistema simplificado sem YouTube API complexa

        // YouTube State Change
        function onYTStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updatePlayButton();
                startLyrics();
                console.log('YouTube tocando');
            } else if (event.data === YT.PlayerState.PAUSED) {
                isPlaying = false;
                updatePlayButton();
                pauseLyrics();
                console.log('YouTube pausado');
            } else if (event.data === YT.PlayerState.ENDED) {
                console.log('YouTube terminou');
                playNext();
            }
        }

        // Tocar YouTube (método otimizado)
        function playYouTube(videoId) {
            if (!videoId) {
                console.error('ID do YouTube inválido');
                showToast('ID do YouTube inválido', 'error');
                return;
            }

            // Pausar áudio HTML5
            elements.audioPlayer.pause();
            elements.audioPlayer.src = '';

            if (!isYouTubeReady || !youtubePlayer) {
                console.log('Aguardando YouTube Player...');
                
                // Aguardar player ficar pronto
                const waitForPlayer = setInterval(() => {
                    if (isYouTubeReady && youtubePlayer) {
                        clearInterval(waitForPlayer);
                        loadAndPlayYouTube(videoId);
                    }
                }, 200);
                
                // Timeout de segurança
                setTimeout(() => {
                    clearInterval(waitForPlayer);
                    if (!isYouTubeReady) {
                        showToast('Erro: YouTube não carregou', 'error');
                    }
                }, 10000);
                
                return;
            }
            
            loadAndPlayYouTube(videoId);
        }

        // Carregar e tocar YouTube
        function loadAndPlayYouTube(videoId) {
            try {
                console.log('Carregando YouTube:', videoId);
                
                youtubePlayer.loadVideoById(videoId);
                
                // Aguardar carregamento e tocar
                setTimeout(() => {
                    if (youtubePlayer && youtubePlayer.playVideo) {
                        youtubePlayer.playVideo();
                    }
                }, 800);
                
            } catch (error) {
                console.error('Erro ao tocar YouTube:', error);
                showToast('Erro ao reproduzir YouTube', 'error');
                isPlaying = false;
                updatePlayButton();
            }
        }

        // Toggle Play/Pause
        function togglePlayPause() {
            if (!currentSong) return;
            
            if (currentSong.type === 'youtube') {
                // Para YouTube, abrir em nova aba
                const youtubeUrl = `https://www.youtube.com/watch?v=${currentSong.youtubeId}`;
                window.open(youtubeUrl, '_blank');
                showToast('Abrindo YouTube em nova aba');
                return;
            }
            
            // Para arquivos MP3
            if (isPlaying) {
                elements.audioPlayer.pause();
                isPlaying = false;
                pauseLyrics();
            } else {
                const playPromise = elements.audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        isPlaying = true;
                        startLyrics();
                    }).catch(error => {
                        console.error('Erro ao tocar:', error);
                        showToast('Erro ao reproduzir áudio');
                    });
                }
            }
            updatePlayButton();
        }

        // Atualizar botão de play
        function updatePlayButton() {
            const icon = elements.playPauseBtn.querySelector('i');
            icon.className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
        }

        // Música anterior
        function playPrevious() {
            if (currentIndex > 0) {
                playSong(currentIndex - 1);
            } else {
                playSong(filteredSongs.length - 1);
            }
        }

        // Próxima música
        function playNext() {
            if (currentIndex < filteredSongs.length - 1) {
                playSong(currentIndex + 1);
            } else {
                playSong(0);
            }
        }

        // Toggle Shuffle
        function toggleShuffle() {
            // Implementar shuffle
            elements.shuffleBtn.classList.toggle('active');
        }

        // Toggle Repeat
        function toggleRepeat() {
            // Implementar repeat
            elements.repeatBtn.classList.toggle('active');
        }

        // Atualizar progresso
        function updateProgress() {
            if (!currentSong || currentSong.type === 'youtube') return;
            
            const currentTime = elements.audioPlayer.currentTime || 0;
            const duration = elements.audioPlayer.duration || 0;
            
            if (duration > 0 && !isNaN(duration)) {
                const progress = (currentTime / duration) * 100;
                elements.progressFill.style.width = `${Math.min(progress, 100)}%`;
                
                elements.currentTime.textContent = formatTime(currentTime);
                elements.totalTime.textContent = formatTime(duration);
            }
        }

        // Atualizar duração
        function updateDuration() {
            const duration = elements.audioPlayer.duration;
            if (duration && !isNaN(duration)) {
                elements.totalTime.textContent = formatTime(duration);
            }
        }

        // Formatar tempo
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Click na barra de progresso
        function handleProgressClick(e) {
            if (!currentSong) return;
            
            const rect = elements.progressBar.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const width = rect.width;
            const percentage = Math.max(0, Math.min(1, clickX / width));
            
            try {
                if (currentSong.type === 'youtube' && youtubePlayer && isYouTubeReady) {
                    const duration = youtubePlayer.getDuration();
                    if (duration > 0) {
                        const newTime = duration * percentage;
                        youtubePlayer.seekTo(newTime, true);
                        console.log(`YouTube seek para: ${formatTime(newTime)}`);
                    }
                } else {
                    const duration = elements.audioPlayer.duration;
                    if (duration && !isNaN(duration)) {
                        elements.audioPlayer.currentTime = duration * percentage;
                    }
                }
            } catch (error) {
                console.error('Erro ao buscar posição:', error);
                showToast('Erro ao navegar na música', 'error');
            }
        }

        // Volume
        function handleVolumeClick(e) {
            const rect = elements.volumeSlider.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const width = rect.width;
            const volume = Math.max(0, Math.min(1, clickX / width));
            
            elements.audioPlayer.volume = volume;
            updateVolumeDisplay(volume);
        }

        // Atualizar display do volume
        function updateVolumeDisplay(volume) {
            elements.volumeFill.style.width = `${volume * 100}%`;
            
            const icon = elements.volumeBtn.querySelector('i');
            if (volume === 0) {
                icon.className = 'fas fa-volume-mute';
            } else if (volume < 0.5) {
                icon.className = 'fas fa-volume-down';
            } else {
                icon.className = 'fas fa-volume-up';
            }
        }

        // Toggle Mute
        function toggleMute() {
            const currentVolume = elements.audioPlayer.volume;
            
            if (currentVolume > 0) {
                elements.audioPlayer.volume = 0;
                updateVolumeDisplay(0);
            } else {
                elements.audioPlayer.volume = 1;
                updateVolumeDisplay(1);
            }
        }

        // Modal de Senha
        function openPasswordModal() {
            elements.passwordModal.classList.add('active');
            elements.passwordInput.focus();
        }

        function closePasswordModal() {
            elements.passwordModal.classList.remove('active');
            elements.passwordInput.value = '';
        }

        function checkPassword() {
            const password = elements.passwordInput.value;
            
            if (password === 'admin123') {
                isAuthenticated = true;
                closePasswordModal();
                openAdminPanel();
                showToast('Acesso liberado!');
            } else {
                elements.passwordInput.classList.add('shake');
                setTimeout(() => {
                    elements.passwordInput.classList.remove('shake');
                }, 500);
                showToast('Senha incorreta!', 'error');
            }
        }

        // Admin Panel
        function openAdminPanel() {
            elements.adminPanel.classList.add('active');
        }

        function closeAdminPanel() {
            elements.adminPanel.classList.remove('active');
        }

        // Handle URL Input
        function handleUrlInput() {
            const url = elements.musicUrl.value.trim();
            
            // Limpar arquivo se URL foi preenchida
            if (url) {
                elements.musicFile.value = '';
            }
            
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                // Extrair informações do YouTube
                const videoId = extractYouTubeId(url);
                if (videoId) {
                    fetchYouTubeInfo(videoId);
                }
            }
        }

        // Handle File Upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Limpar URL se arquivo foi selecionado
            elements.musicUrl.value = '';
            
            // Verificar se é arquivo de áudio
            if (!file.type.startsWith('audio/')) {
                showToast('Por favor, selecione um arquivo de áudio válido!', 'error');
                elements.musicFile.value = '';
                return;
            }
            
            // Verificar tamanho (máximo 50MB)
            const maxSize = 50 * 1024 * 1024; // 50MB
            if (file.size > maxSize) {
                showToast('Arquivo muito grande! Máximo 50MB.', 'error');
                elements.musicFile.value = '';
                return;
            }
            
            // Auto-preencher nome se estiver vazio
            if (!elements.musicTitle.value) {
                const fileName = file.name.replace(/\.[^/.]+$/, ""); // Remove extensão
                elements.musicTitle.value = fileName;
            }
            
            // Converter arquivo para base64 para armazenamento permanente
            const reader = new FileReader();
            reader.onload = function(e) {
                // Armazenar dados do arquivo temporariamente
                window.tempFileData = {
                    data: e.target.result,
                    name: file.name,
                    type: file.type,
                    size: file.size
                };
                showToast('Arquivo carregado: ' + file.name);
                console.log('Arquivo convertido para base64:', file.name);
            };
            reader.onerror = function() {
                showToast('Erro ao processar arquivo!', 'error');
                elements.musicFile.value = '';
            };
            reader.readAsDataURL(file);
        }

        // Extrair ID do YouTube (método mais robusto)
        function extractYouTubeId(url) {
            let id = null;

            if (url.includes("youtu.be")) {
                id = url.split("youtu.be/")[1].split("?")[0].split("&")[0];
            } else if (url.includes("v=")) {
                id = url.split("v=")[1].split("&")[0];
            } else if (url.includes("embed/")) {
                id = url.split("embed/")[1].split("?")[0];
            }

            // Verificar se o ID tem 11 caracteres (padrão YouTube)
            return (id && id.length === 11) ? id : null;
        }

        // Buscar informações do YouTube
        function fetchYouTubeInfo(videoId) {
            fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.title) {
                        elements.musicTitle.value = data.title;
                        elements.musicArtist.value = data.author_name || '';
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar informações do YouTube:', error);
                });
        }

        // Seleção de Ícones
        function handleIconSelection(e) {
            const iconOption = e.target.closest('.icon-option');
            if (!iconOption) return;
            
            document.querySelectorAll('.icon-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            iconOption.classList.add('selected');
        }

        // Seleção de Temas
        function handleThemeSelection(e) {
            const themeOption = e.target.closest('.theme-option');
            if (!themeOption) return;
            
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            themeOption.classList.add('selected');
        }

        // Validar URL
        function validateUrl(url) {
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        }

        // Adicionar Música
        function handleAddMusic(e) {
            e.preventDefault();
            
            const url = elements.musicUrl.value.trim();
            const file = elements.musicFile.files[0];
            const title = elements.musicTitle.value.trim();
            const artist = elements.musicArtist.value.trim();
            const lyrics = elements.musicLyrics.value.trim();
            const lyricsInterval = parseInt(elements.lyricsInterval.value) || 3;
            
            const selectedIcon = document.querySelector('.icon-option.selected');
            const selectedTheme = document.querySelector('.theme-option.selected');
            
            // Verificar se tem URL ou arquivo
            if (!url && !file) {
                showToast('Adicione uma URL ou selecione um arquivo!', 'error');
                return;
            }
            
            if (!title || !artist) {
                showToast('Preencha o título e artista!', 'error');
                return;
            }
            
            // Se tem URL, validar
            if (url && !validateUrl(url)) {
                showToast('URL inválida! Verifique o link.', 'error');
                return;
            }
            
            // Preparar dados da música
            let songData = {
                title,
                artist,
                icon: selectedIcon ? selectedIcon.dataset.icon : 'fas fa-music',
                theme: selectedTheme ? selectedTheme.dataset.theme : 'sweater',
                lyrics,
                lyricsInterval,
                favorite: false,
                createdAt: Date.now()
            };
            
            // Processar arquivo ou URL
            if (file || window.tempFileData) {
                // Arquivo local - usar dados base64
                const fileData = window.tempFileData;
                if (!fileData) {
                    showToast('Erro: Arquivo não processado corretamente!', 'error');
                    return;
                }
                
                songData.url = fileData.data; // Base64 data URL
                songData.type = 'mp3';
                songData.fileName = fileData.name;
                songData.fileSize = fileData.size;
                songData.mimeType = fileData.type;
                songData.isLocalFile = true;
                
                console.log('Processando arquivo local:', fileData.name);
                
                // Limpar dados temporários
                window.tempFileData = null;
                
            } else if (url) {
                // URL externa
                songData.url = url;
                
                if (url.includes('youtube.com') || url.includes('youtu.be')) {
                    songData.type = 'youtube';
                    songData.youtubeId = extractYouTubeId(url);
                    
                    if (!songData.youtubeId) {
                        showToast('ID do YouTube inválido!', 'error');
                        return;
                    }
                    
                    // URLs adicionais para compatibilidade
                    songData.embedUrl = `https://www.youtube.com/embed/${songData.youtubeId}?enablejsapi=1`;
                    songData.directUrl = `https://www.youtube.com/watch?v=${songData.youtubeId}`;
                    
                } else {
                    songData.type = 'mp3';
                    
                    // Verificar se é uma URL de áudio válida
                    const audioExtensions = ['.mp3', '.wav', '.ogg', '.m4a', '.aac'];
                    const hasAudioExtension = audioExtensions.some(ext => 
                        url.toLowerCase().includes(ext)
                    );
                    
                    if (!hasAudioExtension && !url.includes('blob:') && !url.includes('data:')) {
                        showToast('URL pode não ser um arquivo de áudio válido', 'error');
                        console.warn('URL pode não ser áudio:', url);
                    }
                }
            }
            
            console.log('Adicionando música:', songData);
            
            // Salvar no Firebase
            const songsRef = window.firebaseRef(window.firebaseDB, 'songs');
            window.firebasePush(songsRef, songData)
                .then(() => {
                    showToast('Música adicionada com sucesso!');
                    elements.addMusicForm.reset();
                    closeAdminPanel();
                    
                    // Resetar seleções
                    document.querySelectorAll('.icon-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    document.querySelector('.icon-option').classList.add('selected');
                    
                    document.querySelectorAll('.theme-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    document.querySelector('.theme-option').classList.add('selected');
                    
                    console.log('Música salva no Firebase');
                })
                .catch(error => {
                    console.error('Erro ao adicionar música:', error);
                    showToast('Erro ao adicionar música!', 'error');
                });
        }

        // Toggle Favorito
        function toggleFavorite(event, songId) {
            event.stopPropagation();
            
            const song = songs.find(s => s.id === songId);
            if (!song) return;
            
            const newFavoriteStatus = !song.favorite;
            
            const songRef = window.firebaseRef(window.firebaseDB, `songs/${songId}`);
            window.firebaseSet(songRef, {
                ...song,
                favorite: newFavoriteStatus
            })
            .then(() => {
                showToast(newFavoriteStatus ? 'Adicionado aos favoritos!' : 'Removido dos favoritos!');
            })
            .catch(error => {
                console.error('Erro ao atualizar favorito:', error);
                showToast('Erro ao atualizar favorito!', 'error');
            });
        }

        // Mudar Tema
        function changeTheme(theme) {
            currentTheme = theme;
            
            // Remover todas as classes de tema
            elements.appContainer.className = 'app-container theme-particles';
            
            // Adicionar nova classe de tema
            elements.appContainer.classList.add(`theme-${theme}`);
            
            // Recriar partículas
            createParticles();
        }

        // Criar Partículas
        function createParticles() {
            elements.floatingParticles.innerHTML = '';
            
            // Criar 8 partículas iniciais (meio termo)
            for (let i = 0; i < 8; i++) {
                createParticle(i * 800); // Espaçamento moderado
            }
            
            // Continuar criando partículas com frequência moderada
            setInterval(() => {
                if (elements.floatingParticles.children.length < 15) {
                    createParticle();
                }
            }, 2500); // Criar nova partícula a cada 2.5 segundos
        }

        function createParticle(delay = 0) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // Posição horizontal aleatória (evitar bordas)
            const leftPosition = 5 + Math.random() * 90; // 5% a 95%
            particle.style.left = leftPosition + '%';
            
            // Movimento horizontal sutil (drift)
            const drift = (Math.random() - 0.5) * 80; // -40px a +40px
            particle.style.setProperty('--drift', drift + 'px');
            
            // Duração da animação variada
            const duration = 15 + Math.random() * 8; // 15-23 segundos
            particle.style.animationDuration = duration + 's';
            particle.style.animationDelay = delay + 'ms';
            
            // Tamanho variado para criar hierarquia visual
            const size = 2 + Math.random() * 3; // 2-5px
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            
            // Brilho variado - algumas partículas mais brilhantes
            const brightness = Math.random();
            if (brightness > 0.7) {
                // Partículas mais brilhantes (30% das partículas)
                particle.style.opacity = '0.8';
                particle.style.filter = 'brightness(1.5)';
                particle.style.boxShadow = '0 0 12px currentColor';
            } else if (brightness > 0.4) {
                // Partículas médias (30% das partículas)
                particle.style.opacity = '0.5';
                particle.style.filter = 'brightness(1.2)';
                particle.style.boxShadow = '0 0 8px currentColor';
            } else {
                // Partículas mais sutis (40% das partículas)
                particle.style.opacity = '0.3';
                particle.style.filter = 'brightness(0.8)';
                particle.style.boxShadow = '0 0 4px currentColor';
            }
            
            elements.floatingParticles.appendChild(particle);
            
            // Remover partícula após animação completa
            setTimeout(() => {
                if (particle && particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, (duration * 1000) + delay + 1000);
        }

        // Sistema de Letras
        function prepareLyrics(lyricsText, interval) {
            if (!lyricsText) return;
            
            currentLyrics = lyricsText.split('\n').filter(line => line.trim() !== '');
            currentLyricsIndex = 0;
            
            // Limpar letras anteriores
            elements.lyricsContent.innerHTML = '';
            
            // Preparar todas as linhas
            currentLyrics.forEach((line, index) => {
                const lyricsLine = document.createElement('div');
                lyricsLine.className = 'lyrics-line';
                lyricsLine.textContent = line.trim();
                lyricsLine.dataset.index = index;
                elements.lyricsContent.appendChild(lyricsLine);
            });
        }

        function startLyrics() {
            if (currentLyrics.length === 0) return;
            
            clearInterval(lyricsInterval);
            currentLyricsIndex = 0;
            
            // Mostrar primeira linha
            showLyricsLine(0);
            
            // Configurar intervalo
            const interval = (currentSong && currentSong.lyricsInterval) || 3;
            lyricsInterval = setInterval(() => {
                currentLyricsIndex++;
                if (currentLyricsIndex < currentLyrics.length) {
                    showLyricsLine(currentLyricsIndex);
                } else {
                    clearInterval(lyricsInterval);
                }
            }, interval * 1000);
        }

        function pauseLyrics() {
            clearInterval(lyricsInterval);
        }

        function showLyricsLine(index) {
            const lines = elements.lyricsContent.querySelectorAll('.lyrics-line');
            
            // Fade out linhas anteriores
            lines.forEach((line, i) => {
                if (i < index) {
                    line.classList.add('fade-out');
                    line.classList.remove('active');
                } else if (i === index) {
                    line.classList.add('active');
                    line.classList.remove('fade-out');
                } else {
                    line.classList.remove('active', 'fade-out');
                }
            });
        }

        function showLyricsSidebar() {
            elements.lyricsSidebar.classList.add('active');
        }

        function closeLyricsSidebar() {
            elements.lyricsSidebar.classList.remove('active');
        }

        // Mobile
        function checkMobile() {
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                elements.mobileMenuBtn.style.display = 'block';
                elements.sidebar.classList.add('mobile-hidden');
            } else {
                elements.mobileMenuBtn.style.display = 'none';
                elements.sidebar.classList.remove('mobile-hidden', 'mobile-visible');
            }
        }

        function toggleMobileMenu() {
            elements.sidebar.classList.toggle('mobile-visible');
        }

        // Toast Notifications
        function showToast(message, type = 'success') {
            elements.toast.textContent = message;
            elements.toast.className = `toast ${type}`;
            elements.toast.classList.add('show');
            
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        // Sistema otimizado sem YouTube API complexa

        // Limpar todos os dados
        function clearAllData() {
            if (!window.firebaseDB) {
                showToast('Firebase não disponível!', 'error');
                return;
            }
            
            // Confirmação personalizada
            elements.musicGrid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 48px 24px;">
                    <div style="background: #181818; border-radius: 8px; padding: 32px; max-width: 400px; margin: 0 auto;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: #e53e3e; margin-bottom: 16px;"></i>
                        <h3 style="color: #ffffff; font-size: 24px; margin-bottom: 16px;">Confirmar Exclusão</h3>
                        <p style="color: #b3b3b3; margin-bottom: 24px;">Esta ação irá remover TODAS as músicas permanentemente. Não é possível desfazer.</p>
                        <div style="display: flex; gap: 12px; justify-content: center;">
                            <button onclick="showSettingsTab()" style="padding: 12px 24px; background: #404040; color: #ffffff; border: none; border-radius: 24px; font-weight: 600; cursor: pointer;">
                                Cancelar
                            </button>
                            <button onclick="confirmClearData()" style="padding: 12px 24px; background: #e53e3e; color: #ffffff; border: none; border-radius: 24px; font-weight: 600; cursor: pointer;">
                                Sim, Excluir Tudo
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Confirmar limpeza de dados
        function confirmClearData() {
            const songsRef = window.firebaseRef(window.firebaseDB, 'songs');
            window.firebaseSet(songsRef, null)
                .then(() => {
                    showToast('Todas as músicas foram removidas!');
                    songs = [];
                    filteredSongs = [];
                    currentSong = null;
                    isPlaying = false;
                    
                    // Parar reprodução
                    elements.audioPlayer.pause();
                    elements.audioPlayer.src = '';
                    if (youtubePlayer) {
                        youtubePlayer.stopVideo();
                    }
                    
                    // Resetar player
                    elements.playerTitle.textContent = 'Selecione uma música';
                    elements.playerArtist.textContent = 'Artista';
                    elements.playerCover.innerHTML = '<i class="fas fa-music"></i>';
                    updatePlayButton();
                    
                    // Voltar para configurações
                    showSettingsTab();
                })
                .catch(error => {
                    console.error('Erro ao limpar dados:', error);
                    showToast('Erro ao limpar dados!', 'error');
                });
        }

        // Expor funções globais necessárias
        window.playSong = playSong;
        window.toggleFavorite = toggleFavorite;
        window.downloadSong = downloadSong;
        window.clearAllData = clearAllData;
        window.confirmClearData = confirmClearData;
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99e87b45c45f2d34',t:'MTc2MzE0Mzk5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
